<!DOCTYPE html>
<html>
    <head>
        <title>Schedule API Test</title>
        <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
        <style>
            body {
                font-family: Arial, sans-serif;
                margin: 20px;
                line-height: 1.6;
            }
            button {
                padding: 10px 15px;
                background-color: #4caf50;
                color: white;
                border: none;
                border-radius: 4px;
                cursor: pointer;
                font-size: 14px;
                margin: 10px 0;
            }
            pre {
                background-color: #f5f5f5;
                padding: 10px;
                border-radius: 4px;
                overflow-x: auto;
                max-height: 400px;
                margin-top: 20px;
            }
            .error {
                color: red;
            }
            .success {
                color: green;
            }
        </style>
    </head>
    <body>
        <h1>Schedule API Test</h1>

        <button id="testButton">Test Schedule Generation API</button>
        <button id="checkButton">Check Schedules in Database</button>
        <div id="status"></div>

        <h3>Results:</h3>
        <pre id="result">Results will appear here...</pre>

        <script>
            const apiBaseUrl = "http://localhost:5000/api";

            // Sample schedule data for testing
            const testData = {
                department_id: "6802140acf7fab6f85e1d31a", // Use a real department ID from your database
                start_date: "2025-06-01",
                end_date: "2025-12-01",
                total_weeks: 24,
                events: [],
                courses: [],
                constraints: {},
                schedule_details: [
                    {
                        class_id: "6802140acf7fab6f85e1d31c", // Use a real class ID from your database
                        course_id: "6802140acf7fab6f85e1d323", // Use a real course ID from your database
                        day_of_week: 1,
                        week_number: 1,
                        start_time: "07:30:00",
                        end_time: "09:00:00",
                        is_practical: false,
                        is_exam: false,
                        is_self_study: false,
                        special_event_id: null,
                        notes: "Test schedule from browser",
                    },
                    {
                        class_id: "6802140acf7fab6f85e1d31c",
                        course_id: "6802140acf7fab6f85e1d323",
                        day_of_week: 2,
                        week_number: 1,
                        start_time: "09:10:00",
                        end_time: "10:40:00",
                        is_practical: false,
                        is_exam: false,
                        is_self_study: false,
                        special_event_id: null,
                        notes: "Second test schedule from browser",
                    },
                ],
            };

            document.getElementById("testButton").addEventListener("click", async () => {
                const statusEl = document.getElementById("status");
                const resultEl = document.getElementById("result");

                statusEl.innerHTML = "Sending request...";
                statusEl.className = "";

                try {
                    const response = await axios.post(`${apiBaseUrl}/schedule/generate`, testData);
                    statusEl.innerHTML = "Success! See details below.";
                    statusEl.className = "success";
                    resultEl.textContent = JSON.stringify(response.data, null, 2);
                } catch (error) {
                    statusEl.innerHTML = "Error! See details below.";
                    statusEl.className = "error";

                    if (error.response) {
                        resultEl.textContent = JSON.stringify(
                            {
                                status: error.response.status,
                                data: error.response.data,
                            },
                            null,
                            2
                        );
                    } else {
                        resultEl.textContent = error.message;
                    }
                }
            });

            document.getElementById("checkButton").addEventListener("click", async () => {
                const statusEl = document.getElementById("status");
                const resultEl = document.getElementById("result");

                statusEl.innerHTML = "Checking schedules...";
                statusEl.className = "";

                try {
                    const response = await axios.get(`${apiBaseUrl}/schedules`);
                    statusEl.innerHTML = `Found ${response.data.length} schedules`;
                    statusEl.className = "success";
                    resultEl.textContent = JSON.stringify(response.data.slice(0, 5), null, 2);
                } catch (error) {
                    statusEl.innerHTML = "Error! See details below.";
                    statusEl.className = "error";

                    if (error.response) {
                        resultEl.textContent = JSON.stringify(
                            {
                                status: error.response.status,
                                data: error.response.data,
                            },
                            null,
                            2
                        );
                    } else {
                        resultEl.textContent = error.message;
                    }
                }
            });
        </script>
    </body>
</html>
